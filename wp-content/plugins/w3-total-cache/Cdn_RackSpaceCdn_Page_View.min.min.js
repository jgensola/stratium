jQuery(function(f){function h(a){a.options.height=jQuery(".w3tc_cdn_rackspace_form").height()+30;a.resize()}function g(a){h(a);j()}function j(){var c=jQuery('input[name="service_id"]').val();var a=jQuery('input[name="access_token"]').val();var b=jQuery('input[name="access_region_descriptor"]').val();jQuery.post(ajaxurl,{action:"w3tc_ajax",_wpnonce:w3tc_nonce,service_id:c,access_token:a,access_region_descriptor:b,w3tc_action:"cdn_rackspace_service_get_state"},function(d){var e="unknown";if(d&&d.status){status=d.status}jQuery(".w3tc_rackspace_created_status").html(status);if(status=="deployed"){i(d)}else{setTimeout(j,5000)}},"json").fail(function(){jQuery(".w3tc_rackspace_created_state").html("Failed to obtain state");setTimeout(j,5000)})}function i(a){jQuery(".w3tc_rackspace_cname").html(a.cname);jQuery(".w3tc_rackspace_access_url").html(a.access_url);jQuery(".w3tc_rackspace_created_in_progress").css("display","none");jQuery(".w3tc_rackspace_created_done").css("display","");h(W3tc_Lightbox)}f("body").on("click",".w3tc_cdn_rackspace_authorize",function(){W3tc_Lightbox.open({id:"w3tc-overlay",close:"",width:800,height:300,url:ajaxurl+"?action=w3tc_ajax&_wpnonce="+w3tc_nonce+"&w3tc_action=cdn_rackspace_intro",callback:h})}).on("click",".w3tc_popup_submit",function(){var a=ajaxurl+"?action=w3tc_ajax&_wpnonce="+w3tc_nonce;W3tc_Lightbox.load_form(a,".w3tc_cdn_rackspace_form",h)}).on("click",".w3tc_cdn_rackspace_service_create_done",function(){var a=ajaxurl+"?action=w3tc_ajax&_wpnonce="+w3tc_nonce+"&w3tc_action=cdn_rackspace_service_create_done";W3tc_Lightbox.load_form(a,".w3tc_cdn_rackspace_form",g)}).on("click",".w3tc_cdn_rackspace_protocol",function(){var a="";f("body").find(".w3tc_cdn_rackspace_protocol").each(function(b){if(!jQuery(this).prop("checked")){return}a=f(this).val()});f(".w3tc_cdn_rackspace_cname_http").css("display",(a=="http"?"":"none"));f(".w3tc_cdn_rackspace_cname_https").css("display",(a=="https"?"":"none"))}).on("click",".w3tc_cdn_rackspace_configure_domains",function(){W3tc_Lightbox.open({id:"w3tc-overlay",close:"",width:1000,height:400,url:ajaxurl+"?action=w3tc_ajax&_wpnonce="+w3tc_nonce+"&w3tc_action=cdn_rackspace_configure_domains",callback:function(a){h(a);w3tc_cdn_cnames_assign()}})}).on("click",".w3tc_cdn_rackspace_configure_domains_done",function(){var a=ajaxurl+"?action=w3tc_ajax&_wpnonce="+w3tc_nonce+"&w3tc_action=cdn_rackspace_configure_domains_done";var b=f(".w3tc_cdn_rackspace_form").find("input").each(function(c){var d=f(this).attr("name");if(d){a+="&"+encodeURIComponent(d)+"="+encodeURIComponent(f(this).val())}});W3tc_Lightbox.load(a,function(c){h(c);w3tc_cdn_cnames_assign()})}).on("size_change","#cdn_cname_add",function(){h(W3tc_Lightbox)})});