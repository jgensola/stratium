jQuery(function(b){function e(f){f.options.height=jQuery(".w3tc_cdn_rackspace_form").height()+30;f.resize()}function a(f){e(f);c()}function c(){var f=jQuery('input[name="service_id"]').val();var h=jQuery('input[name="access_token"]').val();var g=jQuery('input[name="access_region_descriptor"]').val();jQuery.post(ajaxurl,{action:"w3tc_ajax",_wpnonce:w3tc_nonce,service_id:f,access_token:h,access_region_descriptor:g,w3tc_action:"cdn_rackspace_service_get_state"},function(j){var i="unknown";if(j&&j.status){status=j.status}jQuery(".w3tc_rackspace_created_status").html(status);if(status=="deployed"){d(j)}else{setTimeout(c,5000)}},"json").fail(function(){jQuery(".w3tc_rackspace_created_state").html("Failed to obtain state");setTimeout(c,5000)})}function d(f){jQuery(".w3tc_rackspace_cname").html(f.cname);jQuery(".w3tc_rackspace_access_url").html(f.access_url);jQuery(".w3tc_rackspace_created_in_progress").css("display","none");jQuery(".w3tc_rackspace_created_done").css("display","");e(W3tc_Lightbox)}b("body").on("click",".w3tc_cdn_rackspace_authorize",function(){W3tc_Lightbox.open({id:"w3tc-overlay",close:"",width:800,height:300,url:ajaxurl+"?action=w3tc_ajax&_wpnonce="+w3tc_nonce+"&w3tc_action=cdn_rackspace_intro",callback:e})}).on("click",".w3tc_popup_submit",function(){var f=ajaxurl+"?action=w3tc_ajax&_wpnonce="+w3tc_nonce;W3tc_Lightbox.load_form(f,".w3tc_cdn_rackspace_form",e)}).on("click",".w3tc_cdn_rackspace_service_create_done",function(){var f=ajaxurl+"?action=w3tc_ajax&_wpnonce="+w3tc_nonce+"&w3tc_action=cdn_rackspace_service_create_done";W3tc_Lightbox.load_form(f,".w3tc_cdn_rackspace_form",a)}).on("click",".w3tc_cdn_rackspace_protocol",function(){var f="";b("body").find(".w3tc_cdn_rackspace_protocol").each(function(g){if(!jQuery(this).prop("checked")){return}f=b(this).val()});b(".w3tc_cdn_rackspace_cname_http").css("display",(f=="http"?"":"none"));b(".w3tc_cdn_rackspace_cname_https").css("display",(f=="https"?"":"none"))}).on("click",".w3tc_cdn_rackspace_configure_domains",function(){W3tc_Lightbox.open({id:"w3tc-overlay",close:"",width:1000,height:400,url:ajaxurl+"?action=w3tc_ajax&_wpnonce="+w3tc_nonce+"&w3tc_action=cdn_rackspace_configure_domains",callback:function(f){e(f);w3tc_cdn_cnames_assign()}})}).on("click",".w3tc_cdn_rackspace_configure_domains_done",function(){var g=ajaxurl+"?action=w3tc_ajax&_wpnonce="+w3tc_nonce+"&w3tc_action=cdn_rackspace_configure_domains_done";var f=b(".w3tc_cdn_rackspace_form").find("input").each(function(j){var h=b(this).attr("name");if(h){g+="&"+encodeURIComponent(h)+"="+encodeURIComponent(b(this).val())}});W3tc_Lightbox.load(g,function(h){e(h);w3tc_cdn_cnames_assign()})}).on("size_change","#cdn_cname_add",function(){e(W3tc_Lightbox)})});